<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js - The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<link rel="stylesheet" href="lib/css/detalhes.css">
		
		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>		

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
			  
			  
			  <section>
					<h2>O mínimo sobre mim</h2>
					<h3><img src="alberto-souza-120.jpeg"/></h3>
					<h3>Alberto Souza</h3>
					<p>
             Instrutor e desenvolvedor pela <a href="http://www.caelum.com.br">Caelum</a>.
					</p>
					<p>
					   Escritor do <a href="https://leanpub.com/playframeworknapratica">Livro PlayFramework na prática</a>, 
					   usuário forte do Play :) e commiter do VRaptor4.
					</p>
				</section>
			  
				<section>
					<h2>Saindo do zero com o PlayFramework</h2>
					<h3 class="fragment">Não vou garantir que é fácil como dizem por aí</h3>
					<p>
						<small><a targer="_blank" href="http://alots.wordpress.com">alots.wordpress.com</a> / <a  targer="_blank" href="http://twitter.com/alberto_souza">@alberto_souza</a></small>
					</p>
				</section>

				<!-- Example of nested vertical slides -->
				<section id="alinhando">
					<section>
						<h2>Mínimo para rodar o primeiro exemplo</h2>
					</section>
					<section>
						<h2><a href="http://www.playframework.com/download">Download do SDK</a></h2>
						<p><img src="tela_download_play.png"/></p>
					</section>
					<section>
						<h2>Criando um novo projeto</h2>
						<code class="bash">play new agendatech</code>
					</section>
					<section>
					    <h2>Entrando no console do Play</h2>
					    <code>play</code>
					</section>					
					<section>
						<h2>Importar para o eclipse</h2>
            <code>eclipse</code>
					</section>
					<section>
						<h2>Subir o servidor</h2>
            <code>~run</code>
					</section>
					<section>
					    <h2>Exemplo de acesso </h2>
					   <p>http://localhost:9000/eventos</p>  
					</section>
					<section>
					   <h2>Quem trata?</h2>  
					</section>
					<section>
					   <h2>Arquivo de rotas!</h2>  
					</section>					
					<section>
            <pre>
                <code>
GET     /eventos   controllers.EventosController.lista()

# Map static resources from the /public folder to the /assets URL path
GET     /assets/*file    controllers.Assets.at(path="/public", file)
                
                </code>
            </pre>
					</section>		
					<section>
					    <pre>
					      <code>
package controllers;

import play.mvc.*;

public class EventosController extends Controller {

    public static Result lista() {
        List&lt;Evento&gt; instrutores = Eventos.paraAcontecer();
        return //tem que ir para a view
    }

}
					        
					      </code>
					    </pre>
					</section>			
					<section>
					    <pre>
					      <code>
public class EventosController extends Controller {

    public static Result lista() {
        List&lt;Evento&gt; instrutores = Eventos.paraAcontecer();
        return ok(views.html.eventos.lista.render(aprovados));
    }

}
					      </code>
					    </pre>
					</section>
					
					<section>
					    <h2>Isso mesmo, invocamos um método que nos retorna a view!</h2>
					</section>
					
					<section>
              <pre>
                <code class="slide-font">
            @(lista: List[Evento])

            @for(evento <- lista){
              @evento.getNome()
            }
                  
                </code>
              </pre>
					</section>
					<section>
					    <h2>Rotas e views viram classes!</h2>
					</section>
					<section>
					    <h2>E quando tiver uma alteração?</h2>
					</section>
					<section>
					    <h2>Mexa livremente que o Play fica atualizando :)</h2>
					</section>
				</section>

				<section>
				  <section>
  					<h2>Decisão sobre tecnologias</h2>
  					<p>
  						Já decidiram algumas, vamos só olhar rapidamente
  					</p>
					</section>
					<section>
					    <h2>Persistência</h2>
					    <ul>
					        <li>Ebean</li>
					        <li>JPA</li>
					    </ul>
					</section>
					<section>
					    <pre>
					      <code>            
    public class EventosController extends Controller {

      public static Result index() {
          List&lt;Evento&gt; eventos = Ebean.find(Evento.class).findList();
          
          
          List&lt;Evento&gt; eventos = JPA.em().ah...UmaFormaFacil()
          
          
          
          return ok(view.instrutores.html.index.render(eventos));
      }

    }					                    
					      </code>
					    </pre>
					</section>
					<section>
					    <h2>Reflexão sobre métodos estáticos</h2>
					</section>
					<section>
					    <h2>Manter estado no controller? Qual o motivo?</h2>
					</section>
					<section>
					    <h2>Voltando para as tecnologias</h2>
					</section>
					<section>
					    <h2>Precisavam de uma view que fosse em Scala</h2>
					</section>
					<section>
					    <h2>
              <a href="https://github.com/spray/twirl">Para a view, Twirl</a>
              </h2>
					</section>
					<section>
					    <pre>
					      <code>
@(eventos:List[Evento])


@if(flash().get("sucesso")!=null){
	<span class="msg_sucesso">@flash().get("sucesso")</span>
}
<ul>
	@for(evento <- eventos) {
		@detalhe_lista(evento)	
	}
</ul>


					        
					      </code>
					    </pre>
					</section>
					<section>
					    <h2>O Agendatech precisa tuitar sobre os eventos</h2>
					</section>
					<section>
					    <h2>Akka para tarefas assíncronas</h2>
					    <pre>
					      <code>
      ActorRef actor = SystemActor.apply(SendTwitterActor.class);
      actor.tell(evento,null);
					      </code>
					    </pre>
					</section>
					<section>
					    <h2>Necessário pegar fotos legais sobre o evento</h2>
					</section>
					<section>
					    <h2>API pronta para requests externos</h2>
					    <pre>
					      <code>
WSRequestHolder requester = 
  WS.url("https://api.instagram.com/v1/tags/qcon2014/...");					          
requester.get();
					      </code>
					    </pre>
					</section>
					<section>
					    <h2>E qual servidor vamos usar para deployar?</h2>
					</section>
					<section>
					    <h2>Netty como servidor http</h2>
              <h3>E a especificação de Servlets?</h3>
					</section>
					<section>
					    <h2>Razões para não seguir a spec</h2>
					    <ul>
					      <li>Não precisar ficar criando adapter para as implementações</li>
					      <li>Como lidar com as respostas assíncronas?</li>					      
					    </ul>
					</section>
				</section>

				<section>
				  <section>
  					<h2>Mega vantagens(Reativo)</h2>
  					<h3>Pelo menos na minha opinião</h3>
					</section>
					<section>
					  <h2>Tudo assíncrono</h2>
					</section>
					<section>
					  <h2>Voltando ao assunto sobre requisições para serviços externos</h2>
					  <pre>
					    <code>
public static Result ultimasFotos(String hashtag){
  WSRequestHolder requester = 
    WS.url("https://api.instagram.com/v1/tags/"+hashtag+"/...");					          

    return ok(requester.get().get().getBody());
}
					    </code>
					  </pre>
					</section>
					<section>
					    <h2>E se o Instagram estiver lerdo?</h2>
					</section>
					
					<section>
					  <h2>Não queremos segurar a Thread!</h2>
					  <pre>
					    <code>
public static Promise&lt;Result&gt; ultimasFotos(String hashtag){
  WSRequestHolder requester = 
    WS.url("https://api.instagram.com/v1/tags/"+hashtag+"/...");					          

  Promise&lt;Response&gt; esperandoAResposta = requester.get();
  esperandoAResposta.map(response -> ok(response.getBody()));	            
}
					    </code>
					  </pre>
					</section>
					<section>
					    <h2>Essa é uma das chaves do sucesso</h2>
					    <h3 class="fragment">Para sua felicidade, pode não ser suficiente</h3>
					</section>
					<section>
					    <h2>Colocando mais servidores</h2>
					    <h3 class="fragment">Escalonamento horizontal</h3>
					</section>
					<section>
					    <h2>E o usuário logado fica onde?</h2>
					</section>
				  <section>
				      <h2>No cliente</h2>
				      <h3 class="fragment">Stateless para a vitória</h3>
				  </section>
					<section>
					  <h2>Sem objetos complexos na session</h2>
					  <pre>
					    <code>
  //não compila!
  session().put("infoDoUsuario",objetoUsuario);

  //agora sim
  session().put("infoDoUsuario",algumaChaveDoUsuario);
					    </code>
					  </pre>
					</section>
  				<section>
  				    <h2>Colocar vários servidores ficou fácil</h2>
  				    <h3>Exemplo Haproxy</h3>
  				    <pre>
  				      <code>
  backend servers
  balance roundrobin

  option httpclose
  option redispatch

  server play1 127.0.0.1:8081  maxconn 32
  server play2 127.0.0.1:8082  maxconn 32

  				      </code>
  				    </pre>
  				</section>
  				<section>
  				  <h2>Sempre que um evento é aprovado, atualiza a home</h2>
  				  <h3 class="fragment">Como fazer?</h3>
  				</section>
  				<section>
  				    <h2>Modo antigo</h2>
  				    <h3 class="fragment">Pings de tempos em tempos no servidor</h3>
  				</section>
  				<section>
  				    <h2>Jeito mais moderno</h2>
  				</section> 
  				<section>
  				  <h2>Server-sent Events</h2>
  				  <h3 class="fragment">Reativo mais uma vez!</h3>
  				</section>				  				 				
  				<section>
  				    <h2>Agora basta fazer o registro</h2>
  				    <pre>
  				      <code>
  var feed = new EventSource('@routes.AtualizaHomeController.registra())');

  feed.addEventListener('message',handlerDoEvento, false);				        
  				      </code>
  				    </pre>
  				</section>  				
  				<section>
  				  <h2>Push notifications</h2>
  				  <pre>
  				    <code>
object AtualizaHomeController extends Controller {

  val (chatOut, chatChannel) = Concurrent.broadcast[JsonNode]  				      
  
  def registra() = Action {
    Ok.feed(chatOut &> EventSource())
    .as("text/event-stream")
  }
}
  				    </code>
  				  </pre>
					</section>
					<section>
					  <h2>E como pushar informações?</h2>
					  <pre>
					    <code>
AtualizaHomeController.chatChannel()
.push(Json.toJson(eventoAprovado));					      
					    </code>
					  </pre>
					</section>
				</section>

				<section>
				  <section>
					  <h2>Fechando!</h2>
					</section>
					<section>
					  <h2>Gerando uma distribuição</h2>
					    <code>
                  play dist
					    </code>  					    
					</section>
					<section>
					  <h2>Deploy</h2>
					    <code>
                  unzip agendatech.zip<br/><br/><br/>
                  deploy/bin/agendatech
					    </code>
					</section>
					<section>
					    <h2>Algumas empresas que já usam</h2>
					    <ul>
					      <li>Coursera</li>
					      <li>Linkedin</li>
					      <li>Klout</li>
					    </ul>
					</section>
					<section class="agradecimento">
					  <img src="title_page.jpg" width="100px" height="100px"/>					  
					</section>					
					
					<section class="agradecimento">
					  <dl>
					    <dt>Livro:</dt>
					    <dd><a href="https://leanpub.com/playframeworknapratica">bit.ly/1hV0NMm</a></dd>
					    <dt>Blog:</dt>
					    <dd><a href="http://alots.wordpress.com">alots.wordpress.com</a></dd>
					  </dl>
					</section>					
					<section>
					  <h1>Obrigado!</h1>
  					<p>
  						<small><a targer="_blank" href="http://alots.wordpress.com">Alberto Souza</a> / <a  targer="_blank" href="http://twitter.com/alberto_souza">@alberto_souza</a></small>
  					</p>            					  
					</section>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

  		var ws = new WebSocket('ws://107.170.147.59:8080/vraptoree-conexaojava/controlador-de-slide/grandebahia');

      Reveal.addEventListener( 'slidechanged', function( event ) {
          ws.send(event.indexh+";"+event.indexv);
          // event.previousSlide, event.currentSlide, event.indexh, event.indexv
      } );
   </script>

	</body>
</html>
